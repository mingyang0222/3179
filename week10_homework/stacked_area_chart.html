<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Global Renewable Energy Composition â€” Percentage Stacked Bar</title>
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>

  <script>
    const spec = {
      "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
      "title": "Global Renewable Energy Composition by Type (as % of Total)",
      "width": 1000,
      "height": 500,
      "data": {
        "url": "global_energy_type_composition.csv",
        "format": {"type": "csv"}
      },
      "mark": "bar",
      "encoding": {
        "x": {
          "field": "Year",
          "type": "ordinal",
          "axis": {"title": "Year", "labelAngle": -45}
        },
        "y": {
          "field": "Production (GWh)",
          "type": "quantitative",
          "stack": "normalize",
          "axis": {"title": "Share of Total Renewable Energy (%)", "format": "%"}
        },
        "color": {
          "field": "Energy Type",
          "type": "nominal",
          "title": "Energy Source"
        },
        "tooltip": [
          {"field": "Year", "title": "Year"},
          {"field": "Energy Type", "title": "Energy Type"},
          {
            "field": "Production (GWh)",
            "title": "Share of Total (%)",
            "type": "quantitative",
            "aggregate": "sum",
            "format": ".1%"
          }
        ]
      },
      "config": {
        "axis": {"labelFontSize": 12, "titleFontSize": 13},
        "legend": {"orient": "right"}
      }
    };

    vegaEmbed("#vis", spec, {mode: "vega-lite"}).then(console.log).catch(console.error);
  </script>
</body>
</html>
